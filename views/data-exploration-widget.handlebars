<div>
        <h2><b>Workbench</b>
        - Explore Data
        </h2>
</div>
<hr/>
<div class="container">
    <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12" class="row justify-content-center">
            <div class="card text-left" style="width: 100%;">
                <div class="card-body">
                <div>
                <h4><i>Simple Graph QL editor to query your data</i></h4> </br>
                </div>
                <div id="graphiql" style="height: 100vh;"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<script crossorigin src="https://unpkg.com/react/umd/react.production.min.js"></script>
<script crossorigin src="https://unpkg.com/react-dom/umd/react-dom.production.min.js"></script>
<script crossorigin src="https://unpkg.com/graphiql/graphiql.min.js"></script>
<script>
  function graphQLFetcher(graphQLParams) {
    var token = "Bearer {{userJwtToken}}"
    var myHeaders = new Headers();
    myHeaders.append("Authorization", token);
    myHeaders.append("Content-Type", "application/json");
    myHeaders.append("Access-Control-Allow-Origin", "*");
    var requestOptions = {
      method: 'POST',
      mode: "cors",
      credentials: "omit",
      redirect: "follow",
      headers: myHeaders,
      body: JSON.stringify(graphQLParams)
    }
    return fetch(
      '/workbench/graphql',
      requestOptions,
    ).then(res => {
      if (res.ok) {
        return res.json();
      } else {
        throw Error(`Request rejected with status ${res.status}`);
      }
    }).catch(err => console.error('Caught error: ', err));
  }
  var defaultQuery="{Person{uri id actions{uri type dataProvider description distance startTime{year month day hour minute second formatted} movingTime elapseTime distance instruments{uri type}}}}";
  ReactDOM.render(
    React.createElement(GraphiQL, {
      fetcher: graphQLFetcher,
      query:defaultQuery,
      docExplorerOpen:false
    }),
    document.getElementById('graphiql'),
  );
</script>
<div class="container">
    <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12" class="row justify-content-center">
            <div class="card text-left" style="width: 100%;">
                <div class="card-body">
                    <div>
                    <h4><i>Here is an extract of what you are playing with </i><i class="material-icons">favorite</i><i class="material-icons">favorite</i><i class="material-icons">favorite</i> </h4> </br>
                    </div>
                    <div id="graph" style="height:800px">Loading data ...</div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    function init() {
                var neo4jd3 = new Neo4jd3('#graph', {
                    highlight: [
                        {
                            class: 'ns0__Person.name',
                            property: 'userId',
                            value: 'person'
                        }
                    ],
                    icons: {
                        'ns0__Person': 'user',
                        'ns0__Action': 'map-marker',
                        'ns0__Vehicle': 'gear'
                    },
                    images: {
                    },
                    colors:[
                        '#66bb6a',
                        '#50dddf',
                        '#2196f3',
                    ],
                    minCollision: 20,
                    neo4jDataUrl: '/auth/workbench/load',
                    nodeRadius: 12,
                    zoomFit: true
                });
            }

            window.onload = init;
</script>
